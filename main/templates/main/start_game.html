<div class="music" id="1" data-like="111">

    노래2
</div>

<br><br>
<div class="music" id="2" data-like="123">

    노래2
</div>

{% block js %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
<script src="//code.jquery.com/jquery-1.12.4.min.js"></script>
<script language="javascript">
    $(document).ready(function () {
        var prev_music = ""
        var curr_music = ""
        var correct = ""
        var cnt = 0
        var point = 0

        $.ajax({
            url: '{% url "main:music_list_of_game" gamename %}',
            type: 'POST',
            success: function (response) {
                for(var i=0; i<response.length; i++)
                    console.log(response[i].music)

                prev_music = response[cnt]
                curr_music = response[cnt+1]
                cnt +=1
                correct = load_quiz(prev_music, curr_music, cnt)

                $(".music").on('click', function () {
                    console.log("클릭한 노래의 좋아요:" + $(this).data('like'))
                    console.log('---------------------')
                    if ($(this).data('like') == correct.music.like) {
                        console.log("정답")
                        point += 1
                        console.log('점수' + point)
                        cnt +=1
                        prev_music = correct
                        curr_music = response[cnt]

                        if(cnt <= response.length){
                            load_quiz(prev_music, curr_music, cnt)
                        }
                        else{
                            console.log('더이상 문제가 없어요')
                            window.location.href= "/" 
                        }
                        
                    } else {
                        console.log("오답")
                        console.log('점수' + point)
                        window.location.href= "/" 
                    }
                });

            },
            error: function (response) {
                console.log(response);
            }
        });
    });

    function load_quiz(prev_music, curr_music, cnt) {
        console.log('---------------------')
        //좋아요 수 비교해 정답 저장
        if (prev_music.music.like < curr_music.music.like)
            correct = curr_music
        else
            correct = prev_music

        $('#1').html(prev_music.music.title + prev_music.music.like)
        $('#1').data('like', prev_music.music.like)
        $('#2').html(curr_music.music.title + curr_music.music.like)
        $('#2').data('like', curr_music.music.like)
        console.log('정답의 좋아요' + correct.music.like)
        return correct
    }
</script>
{% endblock js %}